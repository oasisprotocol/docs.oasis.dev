<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Set up Trusted Execution Environment (TEE) | Oasis Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.oasis.io/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Set up Trusted Execution Environment (TEE) | Oasis Documentation"><meta data-rh="true" name="description" content="In case the ParaTime you want to run does not require the use of a TEE (e.g."><meta data-rh="true" property="og:description" content="In case the ParaTime you want to run does not require the use of a TEE (e.g."><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.oasis.io/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.8caaf724.css">
<script src="/assets/js/runtime~main.0cf6481e.js" defer="defer"></script>
<script src="/assets/js/main.3d5625b3.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/img/logo_dark.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/general/">Use Oasis</a><a class="navbar__item navbar__link" href="/build/">Build</a><a class="navbar__item navbar__link" href="/get-involved/">Get Involved</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/node/">Run Node</a><a class="navbar__item navbar__link" href="/core/">Develop Core</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub repository" aria-label="GitHub repository"></a><a href="https://oasisprotocol.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-www-link" title="Oasis Protocol Foundation website" aria-label="Oasis Protocol Foundation website"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/node/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/node/mainnet/">Mainnet</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/mainnet/eden-upgrade">Eden Upgrade</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/node/mainnet/previous-upgrades">Previous Upgrades</a><button aria-label="Expand sidebar category &#x27;Previous Upgrades&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/mainnet/upgrade-log">Upgrade Log</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" href="/node/testnet/">Testnet</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/testnet/upgrade-log">Upgrade Log</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/node/genesis-doc">Genesis Document</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/node/run-your-node/">Run Your Node</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/node/run-your-node/prerequisites">Prerequisites</a><button aria-label="Collapse sidebar category &#x27;Prerequisites&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/prerequisites/hardware-recommendations">Hardware Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/prerequisites/cloud-providers">Cloud Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/prerequisites/stake-requirements">Stake Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/prerequisites/oasis-node">Install the Oasis Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/prerequisites/system-configuration">System Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee">Set up Trusted Execution Environment (TEE)</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/validator-node">Validator Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/non-validator-node">Non-validator Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/seed-node">Seed Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/archive-node">Archive Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/paratime-node">ParaTime Node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/paratime-client-node">ParaTime Client Node</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/node/run-your-node/keymanager-node/">Key Manager Node</a><button aria-label="Expand sidebar category &#x27;Key Manager Node&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/sentry-node">Sentry Node</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/node/run-your-node/maintenance">Maintenance</a><button aria-label="Expand sidebar category &#x27;Maintenance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/node/run-your-node/advanced">Advanced</a><button aria-label="Expand sidebar category &#x27;Advanced&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/node/run-your-node/troubleshooting">Troubleshooting</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/node/web3">Web3 Gateway</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/node/grpc">gRPC Proxy</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Set up Trusted Execution Environment (TEE)</h1></header>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>In case the ParaTime you want to run does not require the use of a TEE (e.g.
Intel SGX), you can skip setting up a TEE.</p></div></div>
<p>If the ParaTime is configured to run in a TEE (currently only <a href="https://www.intel.com/content/www/us/en/architecture-and-technology/software-guard-extensions.html" target="_blank" rel="noopener noreferrer">Intel SGX</a>), you
must make sure that your system supports running SGX enclaves. This requires
that your hardware has SGX support, that SGX support is enabled and that the
additional driver and software components are properly installed and running.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bios-configuration">BIOS Configuration<a href="#bios-configuration" class="hash-link" aria-label="Direct link to BIOS Configuration" title="Direct link to BIOS Configuration">​</a></h2>
<p>To enable Intel SGX on your hardware, you also need to configure the BIOS.
First, <strong>update the BIOS to the latest version with the latest microcode</strong> and
then proceed with BIOS configuration as shown below. Note that some settings may
not apply to your BIOS. In that case, configure only the relevant ones. Please
set the BIOS settings as follows:</p>
<ul>
<li><strong>SGX</strong>: ENABLE</li>
<li><strong>Hyper-Threading</strong>: DISABLE</li>
<li><strong>Intel SpeedStep</strong>: DISABLE</li>
<li><strong>Turbo Mode</strong>: DISABLE</li>
<li><strong>CPU AES</strong>: ENABLE</li>
<li><strong>SGX Auto MP Registration</strong>: ENABLE</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ensure-clock-synchronization">Ensure Clock Synchronization<a href="#ensure-clock-synchronization" class="hash-link" aria-label="Direct link to Ensure Clock Synchronization" title="Direct link to Ensure Clock Synchronization">​</a></h2>
<p>Due to additional sanity checks within runtime enclaves, you should ensure that
the node&#x27;s local clock is synchronized (e.g. using NTP). If it is off by more
than half a second you may experience unexpected runtime aborts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ensure-proper-sgx-device-permissions">Ensure Proper SGX Device Permissions<a href="#ensure-proper-sgx-device-permissions" class="hash-link" aria-label="Direct link to Ensure Proper SGX Device Permissions" title="Direct link to Ensure Proper SGX Device Permissions">​</a></h2>
<p>Make sure that the user that is running the Oasis Node binary has access to the
SGX device (e.g. <code>/dev/sgx_enclave</code>). This can usually be achieved by adding
the user into the right group, for example in case the permissions of the SGX
device are as follows:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">crw-rw---- 1 root sgx 10, 125 Oct 28 09:28 /dev/sgx_enclave</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and the user running Oasis Node is <code>oasis</code>, you can do:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo adduser oasis sgx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Failure to do so may result in the &quot;permission denied OS error 13&quot; during
runtime startup.</p>
<p>If you are planning to run your node from an interactive session, make sure to
log out for permissions to take effect.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="aesm-service">AESM Service<a href="#aesm-service" class="hash-link" aria-label="Direct link to AESM Service" title="Direct link to AESM Service">​</a></h2>
<p>To allow execution of SGX enclaves, several <strong>Architectural Enclaves (AE)</strong> are
involved (i.e. Launch Enclave, Provisioning Enclave, Provisioning Certificate
Enclave, Quoting Enclave, Platform Services Enclaves).</p>
<p>Communication between application-spawned SGX enclaves and Intel-provided
Architectural Enclaves is through <strong>Application Enclave Service Manager
(AESM)</strong>. AESM runs as a daemon and provides a socket through which applications
can facilitate various SGX services such as launch approval, remote attestation
quote signing, etc.</p>
<p>Oasis node requires the use of DCAP attestation. To see if your system supports
it, run the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> cpuid -1  | grep &quot;SGX&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>and look for the following line:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      SGX_LC: SGX launch config supported      = true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dcap-attestation">DCAP Attestation<a href="#dcap-attestation" class="hash-link" aria-label="Direct link to DCAP Attestation" title="Direct link to DCAP Attestation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ubuntu-2204">Ubuntu 22.04+<a href="#ubuntu-2204" class="hash-link" aria-label="Direct link to Ubuntu 22.04+" title="Direct link to Ubuntu 22.04+">​</a></h3>
<p>A convenient way to install the AESM service on Ubuntu 22.04 systems
is to use the Intel&#x27;s <a href="https://download.01.org/intel-sgx/sgx_repo/" target="_blank" rel="noopener noreferrer">official Intel SGX APT repository</a>.</p>
<p>First add Intel SGX APT repository to your system:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -fsSL https://download.01.org/intel-sgx/sgx_repo/ubuntu/intel-sgx-deb.key | sudo gpg --dearmor -o /usr/share/keyrings/intel-sgx-deb.gpg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/intel-sgx-deb.gpg] https://download.01.org/intel-sgx/sgx_repo/ubuntu $(lsb_release -cs) main&quot; | sudo tee /etc/apt/sources.list.d/intel-sgx.list &gt; /dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And then install the <code>sgx-aesm-service</code>, <code>libsgx-aesm-ecdsa-plugin</code>, <code>libsgx-aesm-quote-ex-plugin</code> and <code>libsgx-dcap-default-qpl</code> packages:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install sgx-aesm-service libsgx-aesm-ecdsa-plugin libsgx-aesm-quote-ex-plugin libsgx-dcap-default-qpl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The AESM service should be up and running. To confirm that, use:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl status aesmd.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-the-quote-provider">Configuring the Quote Provider<a href="#configuring-the-quote-provider" class="hash-link" aria-label="Direct link to Configuring the Quote Provider" title="Direct link to Configuring the Quote Provider">​</a></h3>
<p>The Intel Quote Provider (<code>libsgx-dcap-default-qpl</code>) needs to be configured in
order to use either the Intel PCS, the PCCS of your cloud service provider, or
your own PCCS. The configuration file is located at <code>/etc/sgx_default_qcnl.conf</code>.</p>
<p>Make sure to always restart the <code>aesmd.service</code> after updating the
configuration, via:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart aesmd.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="intel-pcs">Intel PCS<a href="#intel-pcs" class="hash-link" aria-label="Direct link to Intel PCS" title="Direct link to Intel PCS">​</a></h4>
<p>Using the Intel PCS is the simplest and most generic way, but it may be less
reliable than using your own PCCS. Some cloud providers (see the <a href="#cloud-service-providers-pccs">following section</a>)
also require you to use their PCCS.</p>
<p>To use Intel PCS update the <code>pccs_url</code> value in <code>/etc/sgx_default_qcnl.conf</code>
to the Intel PCS API URL:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">//PCCS server address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;pccs_url&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://api.trustedservices.intel.com/sgx/certification/v4/&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In case there is an error in the QPL configuration file, attestation will refuse
to work and the AESM service may produce unhelpful errors like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Couldn&#x27;t find the platform library. (null)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The only thing that needs to be changed is the <code>pccs_url</code> value above. <strong>Do not
add any comments and/or modify punctuation as these could make the configuration
file invalid.</strong></p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-service-providers-pccs">Cloud Service Provider&#x27;s PCCS<a href="#cloud-service-providers-pccs" class="hash-link" aria-label="Direct link to Cloud Service Provider&#x27;s PCCS" title="Direct link to Cloud Service Provider&#x27;s PCCS">​</a></h4>
<p>Some cloud providers require you to use their PCCS.</p>
<ul>
<li>
<p>Azure: See the <a href="https://learn.microsoft.com/en-us/azure/security/fundamentals/trusted-hardware-identity-management#how-do-i-use-intel-qpl-with-trusted-hardware-identity-management" target="_blank" rel="noopener noreferrer">Azure documentation</a> for details on configuring the quote provider. The documentation
contains an example of an Intel QPL configuration file that can be used.</p>
</li>
<li>
<p>Alibaba Cloud: See the <a href="https://www.alibabacloud.com/help/en/ecs/user-guide/build-an-sgx-encrypted-computing-environment" target="_blank" rel="noopener noreferrer">Alibaba Cloud documentation</a> for details on configuring the quote provider. The
documentation shows the required <code>sgx_default_qcnl.conf</code> changes.</p>
</li>
<li>
<p>IBM Cloud: See the <a href="https://cloud.ibm.com/docs/vpc?topic=vpc-about-attestation-sgx-dcap-vpc" target="_blank" rel="noopener noreferrer">IBM Cloud documentation</a> for details on configuring the quote provider. The
documentation shows the required <code>sgx_default_qcnl.conf</code> changes.</p>
</li>
<li>
<p>Other cloud providers: If you are using a different cloud service provider, consult their
specific documentation for the appropriate PCCS configuration and guidance on configuring the quote provider, or
use one of the other PCCS options.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="own-pccs">Own PCCS<a href="#own-pccs" class="hash-link" aria-label="Direct link to Own PCCS" title="Direct link to Own PCCS">​</a></h4>
<p>It is also possible to run PCCS yourself. Follow <a href="https://www.intel.com/content/www/us/en/developer/articles/guide/intel-software-guard-extensions-data-center-attestation-primitives-quick-install-guide.html" target="_blank" rel="noopener noreferrer">official Intel instructions</a> on how to setup your own PCCS.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dcap-attestation-docker">DCAP Attestation Docker<a href="#dcap-attestation-docker" class="hash-link" aria-label="Direct link to DCAP Attestation Docker" title="Direct link to DCAP Attestation Docker">​</a></h3>
<p>Alternatively, an easy way to install and run the AESM service on a <a href="https://docs.docker.com/engine/" target="_blank" rel="noopener noreferrer">Docker</a>-enabled
system is to use <a href="https://github.com/oasisprotocol/oasis-core/pkgs/container/aesmd" target="_blank" rel="noopener noreferrer">our AESM container image</a>.</p>
<p>Executing the following command should (always) pull the latest version of our
AESMD Docker container, map the SGX devices and <code>/var/run/aesmd</code> directory
and ensure AESM is running in the background (also automatically started on boot):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pull always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --device /dev/sgx_enclave \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --device /dev/sgx_provision \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --volume /var/run/aesmd:/var/run/aesmd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name aesmd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ghcr.io/oasisprotocol/aesmd-dcap:master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, the Intel Quote Provider in the docker container is configured to use the Intel PCS endpoint.
To override the Intel Quote Provider configuration within the container mount your own custom configuration using
the <code>volume</code> flag.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --pull always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --restart always \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --device /dev/sgx_enclave \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --device /dev/sgx_provision \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --volume /var/run/aesmd:/var/run/aesmd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --volume /etc/sgx_default_qcnl.conf:/etc/sgx_default_qcnl.conf \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --name aesmd \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ghcr.io/oasisprotocol/aesmd-dcap:master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The default Intel Quote Provider config is available in <a href="https://github.com/intel/SGXDataCenterAttestationPrimitives/blob/master/QuoteGeneration/qcnl/linux/sgx_default_qcnl.conf" target="_blank" rel="noopener noreferrer">Intel SGX Github repository</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-socket-systems">Multi-socket Systems<a href="#multi-socket-systems" class="hash-link" aria-label="Direct link to Multi-socket Systems" title="Direct link to Multi-socket Systems">​</a></h3>
<p>Note that platform provisioning for multi-socket systems (e.g. systems with
multiple CPUs) is more complex, especially if one is using a hypervisor and
running SGX workloads inside guest VMs. In this case additional provisioning may
be required to be performed on the host.</p>
<p>Note that the system must be booted in UEFI mode for provisioning to work as the
provisioning process uses UEFI variables to communicate with the BIOS. In
addition the <strong>SGX Auto MP Registration</strong> BIOS configuration setting should be
set to <em>enabled</em>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ubuntu-2204-1">Ubuntu 22.04+<a href="#ubuntu-2204-1" class="hash-link" aria-label="Direct link to Ubuntu 22.04+" title="Direct link to Ubuntu 22.04+">​</a></h4>
<p>To provision and register your multi-socket system you need to install the Intel
SGX Multi-Package Registration Agent Service as follows (assuming Intel&#x27;s SGX
apt repository has been added as discussed above):</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install sgx-ra-service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After boot, the log in <code>/var/log/mpa_registration.log</code> should indicate
successful registration. If an error is reported, make sure that you have
enabled SGX Auto MP Registration in the BIOS as mentioned above. You can also
perform re-provisioning by rebooting and setting the <strong>SGX Factory Reset</strong>
option to <em>enabled</em>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="vmware-vsphere-80">VMware vSphere 8.0+<a href="#vmware-vsphere-80" class="hash-link" aria-label="Direct link to VMware vSphere 8.0+" title="Direct link to VMware vSphere 8.0+">​</a></h4>
<p>In order to enable SGX remote attestation on VMware vSphere-based systems,
please follow <a href="https://docs.vmware.com/en/VMware-vSphere/8.0/vsphere-vcenter-esxi-management/GUID-F16476FD-3B66-462F-B7FB-A456BEDC3549.html" target="_blank" rel="noopener noreferrer">the vSphere guide</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-from-epid-attestation-to-dcap-attestation">Migrate from EPID Attestation to DCAP Attestation<a href="#migrate-from-epid-attestation-to-dcap-attestation" class="hash-link" aria-label="Direct link to Migrate from EPID Attestation to DCAP Attestation" title="Direct link to Migrate from EPID Attestation to DCAP Attestation">​</a></h2>
<p>EPID attestation will be discontinued in 2025 and will no longer be available on
any processors. All nodes using EPID attestation must migrate to DCAP
attestation.</p>
<p>For transitioning to the DCAP attestation, follow these steps:</p>
<ol>
<li>See if your system <a href="#aesm-service">supports DCAP attestation</a>. If your hardware does not
support DCAP attestation, you&#x27;ll need to migrate your node to newer hardware.</li>
<li>Transition to DCAP attestation:</li>
</ol>
<ul>
<li>In case you are running AESM service on Docker follow <a href="#dcap-attestation-docker">these instructions</a>.</li>
<li>Otherwise manually configure AESM service to use DCAP attestation:<!-- -->
<ol>
<li>Remove any leftover EPID attestation packages. If running on Ubuntu 22.04 run
the following command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  sudo apt remove libsgx-aesm-launch-plugin libsgx-aesm-epid-plugin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Configure AESM service to use <a href="#dcap-attestation">DCAP attestation</a></li>
<li>Restart the AESM service. If running on Ubuntu 22.04 run the following
command:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo systemctl restart aesmd.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<ol start="3">
<li><a href="#configuring-the-quote-provider">Configure the Quote Provider</a>.</li>
<li>Use the <a href="#oasis-attestation-tool">attestation tool</a> to test if your settings are correct.</li>
<li>Restart your compute node and verify that node is <code>ready</code>.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="check-sgx-setup">Check SGX Setup<a href="#check-sgx-setup" class="hash-link" aria-label="Direct link to Check SGX Setup" title="Direct link to Check SGX Setup">​</a></h2>
<p>In order to make sure that your SGX setup is working, you can use the
<code>sgx-detect</code> tool from the <a href="https://lib.rs/crates/sgxs-tools" target="_blank" rel="noopener noreferrer">sgxs-tools</a> Rust
package.</p>
<p>There are no pre-built packages for it, so you will need to compile it yourself.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-dependencies">Install Dependencies<a href="#install-dependencies" class="hash-link" aria-label="Direct link to Install Dependencies" title="Direct link to Install Dependencies">​</a></h3>
<p>Make sure you have the following installed on your system:</p>
<ul>
<li><a href="https://gcc.gnu.org" target="_blank" rel="noopener noreferrer">GCC</a>.</li>
<li><a href="https://github.com/protocolbuffers/protobuf" target="_blank" rel="noopener noreferrer">Protobuf</a> compiler.</li>
<li><a href="https://www.freedesktop.org/wiki/Software/pkg-config" target="_blank" rel="noopener noreferrer">pkg-config</a>.</li>
<li><a href="https://www.openssl.org" target="_blank" rel="noopener noreferrer">OpenSSL</a> development package.</li>
</ul>
<p>On Fedora, you can install all the above with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo dnf install gcc protobuf-compiler pkg-config openssl-devel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>On Ubuntu, you can install all the above with:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install gcc protobuf-compiler pkg-config libssl-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-rust">Install <a href="https://www.rust-lang.org" target="_blank" rel="noopener noreferrer">Rust</a><a href="#install-rust" class="hash-link" aria-label="Direct link to install-rust" title="Direct link to install-rust">​</a></h3>
<p>We follow <a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener noreferrer">Rust upstream&#x27;s recommendation</a>
on using <a href="https://rustup.rs" target="_blank" rel="noopener noreferrer">rustup</a> to install and manage Rust versions.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>rustup cannot be installed alongside a distribution packaged Rust version. You
will need to remove it (if it&#x27;s present) before you can start using rustup.</p></div></div>
<p>Install rustup by running:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you want to avoid directly executing a shell script fetched the internet, you
can also <a href="https://rust-lang.github.io/rustup/installation/other.html" target="_blank" rel="noopener noreferrer">download <code>rustup-init</code> executable for your platform</a>
and run it manually. This will run <code>rustup-init</code> which will download and install
the latest stable version of Rust on your system.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-and-install-sgxs-tools">Build and Install sgxs-tools<a href="#build-and-install-sgxs-tools" class="hash-link" aria-label="Direct link to Build and Install sgxs-tools" title="Direct link to Build and Install sgxs-tools">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cargo install sgxs-tools</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-sgx-detect-tool">Run <code>sgx-detect</code> Tool<a href="#run-sgx-detect-tool" class="hash-link" aria-label="Direct link to run-sgx-detect-tool" title="Direct link to run-sgx-detect-tool">​</a></h3>
<p>After the installation completes, run <code>sgx-detect</code> to make sure that everything
is set up correctly:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo $(which sgx-detect)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you don&#x27;t run the <code>sgx-detect</code> tool as <code>root</code>, it might not have the
necessary permissions to access the SGX kernel device.</p></div></div>
<p>When everything works, you should get output similar to the following (some
things depend on hardware features so your output may differ):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Detecting SGX, this may take a minute...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✔  SGX instruction set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  CPU support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  CPU configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  Enclave attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  Enclave Page Cache</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SGX features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ✔  SGX2  ✔  EXINFO  ✔  ENCLV  ✔  OVERSUB  ✔  KSS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Total EPC size: 92.8MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✘  Flexible launch control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  CPU support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ？ CPU configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✘  Able to launch production mode enclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">✔  SGX system software</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  SGX kernel device (/dev/sgx_enclave)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✘  libsgx_enclave_common</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  AESM service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ✔  Able to launch enclaves</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ✔  Debug mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ✘  Production mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ✔  Production mode (Intel whitelisted)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The important part is the checkbox under <em>Able to launch enclaves</em> in both
<em>Debug mode</em> and <em>Production mode (Intel whitelisted)</em>.</p>
<p>In case you encounter errors, see the <a href="https://edp.fortanix.com/docs/installation/help/" target="_blank" rel="noopener noreferrer">list of common SGX installation issues</a>
for help.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="oasis-attestation-tool">Oasis Attestation tool<a href="#oasis-attestation-tool" class="hash-link" aria-label="Direct link to Oasis Attestation tool" title="Direct link to Oasis Attestation tool">​</a></h3>
<p>To test if your settings are correct, you may use the <a href="#oasis-attestation-tool">attestation tool</a>
(<a href="https://github.com/oasisprotocol/tools/releases" target="_blank" rel="noopener noreferrer">binary</a>) for testing remote attestation against Intel SGX&#x27;s
development server.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>See  <a href="/node/run-your-node/troubleshooting">the general troubleshooting section</a>, before
proceeding with ParaTime node-specific troubleshooting.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aesm-could-not-be-contacted">AESM could not be contacted<a href="#aesm-could-not-be-contacted" class="hash-link" aria-label="Direct link to AESM could not be contacted" title="Direct link to AESM could not be contacted">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮  SGX system software &gt; AESM service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AESM could not be contacted. AESM is needed for launching enclaves and generating attestations.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please check your AESM installation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: error communicating with aesm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Connection refused (os error 111)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">More information: https://edp.fortanix.com/docs/installation/help/#aesm-service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ensure  you have completed all the necessary installation steps outlined in
<a href="#dcap-attestation">DCAP Attestation</a> section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="aesm-error-30">AESM: error 30<a href="#aesm-error-30" class="hash-link" aria-label="Direct link to AESM: error 30" title="Direct link to AESM: error 30">​</a></h3>
<p>If you are encountering the following error message in your node&#x27;s logs:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">failed to initialize TEE: error while getting quote info from AESMD: aesm: error 30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ensure you have all required SGX driver libraries installed as listed in
<a href="#dcap-attestation">DCAP Attestation</a> section.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permission-denied-when-accessing-sgx-kernel-device">Permission Denied When Accessing SGX Kernel Device<a href="#permission-denied-when-accessing-sgx-kernel-device" class="hash-link" aria-label="Direct link to Permission Denied When Accessing SGX Kernel Device" title="Direct link to Permission Denied When Accessing SGX Kernel Device">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮  SGX system software &gt; SGX kernel device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Permission denied while opening the SGX device (/dev/sgx/enclave, /dev/sgx or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/isgx). Make sure you have the necessary permissions to create SGX enclaves.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If you are running in a container, make sure the device permissions are</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">correctly set on the container.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: Error opening device: Permission denied (os error 13)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Permission denied (os error 13)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ensure you are running the <code>sgx-detect</code> tool as <code>root</code> via:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo $(which sgx-detect) --verbose</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="error-opening-sgx-kernel-device">Error Opening SGX Kernel Device<a href="#error-opening-sgx-kernel-device" class="hash-link" aria-label="Direct link to Error Opening SGX Kernel Device" title="Direct link to Error Opening SGX Kernel Device">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮  SGX system software &gt; SGX kernel device</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The SGX device (/dev/sgx/enclave, /dev/sgx or /dev/isgx) could not be opened:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;/dev&quot; mounted with `noexec` option.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: Error opening device: &quot;/dev&quot; mounted with `noexec` option</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: &quot;/dev&quot; mounted with `noexec` option</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ensure-dev-is-not-mounted-with-the-noexec-option">Ensure <code>/dev</code> is NOT Mounted with the <code>noexec</code> Option<a href="#ensure-dev-is-not-mounted-with-the-noexec-option" class="hash-link" aria-label="Direct link to ensure-dev-is-not-mounted-with-the-noexec-option" title="Direct link to ensure-dev-is-not-mounted-with-the-noexec-option">​</a></h4>
<p>Some Linux distributions mount <code>/dev</code> with the <code>noexec</code> mount option. If that is
the case, it will prevent the enclave loader from mapping executable pages.</p>
<p>Ensure your <code>/dev</code> (i.e. <code>devtmpfs</code>) is not mounted with the <code>noexec</code> option.
To check that, use:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/mounts | grep devtmpfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To temporarily remove the <code>noexec</code> mount option for <code>/dev</code>, run:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo mount -o remount,exec /dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To permanently remove the <code>noexec</code> mount option for <code>/dev</code>, add the following to
the system&#x27;s <code>/etc/fstab</code> file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">devtmpfs        /dev        devtmpfs    defaults,exec 0 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>This is the recommended way to modify mount options for virtual (i.e. API) file
system as described in <a href="https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/" target="_blank" rel="noopener noreferrer">systemd&#x27;s API File Systems</a>
documentation.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unable-to-launch-enclaves-operation-not-permitted">Unable to Launch Enclaves: Operation not permitted<a href="#unable-to-launch-enclaves-operation-not-permitted" class="hash-link" aria-label="Direct link to Unable to Launch Enclaves: Operation not permitted" title="Direct link to Unable to Launch Enclaves: Operation not permitted">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮  SGX system software &gt; Able to launch enclaves &gt; Debug mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The enclave could not be launched.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: failed to load report enclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: failed to load report enclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Failed to map enclave into memory.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Operation not permitted (os error 1)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Ensure your system&#x27;s <a href="#ensure-dev-is-not-mounted-with-the-noexec-option"><code>/dev</code> is NOT mounted with the <code>noexec</code> mount option</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unable-to-launch-enclaves-invalid-argument">Unable to Launch Enclaves: Invalid argument<a href="#unable-to-launch-enclaves-invalid-argument" class="hash-link" aria-label="Direct link to Unable to Launch Enclaves: Invalid argument" title="Direct link to Unable to Launch Enclaves: Invalid argument">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮  SGX system software &gt; Able to launch enclaves &gt; Debug mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The enclave could not be launched.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: failed to load report enclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Failed to call EINIT.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: I/O ctl failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Invalid argument (os error 22)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This may be related to a bug in the Linux kernel when attempting to run enclaves
on certain hardware configurations. Upgrading the Linux kernel to a version
equal to or greater than 6.5.0 may solve the issue.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="unable-to-launch-enclaves-inputoutput-error">Unable to Launch Enclaves: Input/output error<a href="#unable-to-launch-enclaves-inputoutput-error" class="hash-link" aria-label="Direct link to Unable to Launch Enclaves: Input/output error" title="Direct link to Unable to Launch Enclaves: Input/output error">​</a></h3>
<p>If running <code>sgx-detect --verbose</code> reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">🕮 SGX system software &gt; Able to launch enclaves &gt; Debug mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The enclave could not be launched.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: failed to load report enclave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Failed to call ECREATE.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: I/O ctl failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">debug: cause: Input/output error (os error 5)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This may be related to a bug in the <a href="https://github.com/fortanix/rust-sgx/issues/565" target="_blank" rel="noopener noreferrer"><code>rust-sgx</code></a>
library causing <code>sgx-detect</code> (and <code>attestation-tool</code>) to fail and report that
debug enclaves cannot be launched. This is a known issue and is being worked on.
If the <code>sgx-detect</code> is reporting that production enclaves can be launched, you
can ignore this error when setting up the Oasis node.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="couldnt-find-the-platform-library">Couldn&#x27;t find the platform library<a href="#couldnt-find-the-platform-library" class="hash-link" aria-label="Direct link to Couldn&#x27;t find the platform library" title="Direct link to Couldn&#x27;t find the platform library">​</a></h3>
<p>If AESMD service log reports:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[read_persistent_data ../qe_logic.cpp:1084] Couldn&#x27;t find the platform library. (null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[get_platform_quote_cert_data ../qe_logic.cpp:438] Couldn&#x27;t load the platform library. (null)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It may be that the <a href="#configuring-the-quote-provider">DCAP quote provider</a> is misconfigured or the configuration
file is not a valid JSON file but is malformed. Double-check that its
configuration file (e.g. <code>/etc/sgx_default_qcnl.conf</code>) is correct.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/prerequisites/set-up-trusted-execution-environment-tee.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-02-27T16:36:59.000Z" itemprop="dateModified">Feb 27, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/node/run-your-node/prerequisites/system-configuration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">System Configuration</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/node/run-your-node/validator-node"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Validator Node</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#bios-configuration" class="table-of-contents__link toc-highlight">BIOS Configuration</a></li><li><a href="#ensure-clock-synchronization" class="table-of-contents__link toc-highlight">Ensure Clock Synchronization</a></li><li><a href="#ensure-proper-sgx-device-permissions" class="table-of-contents__link toc-highlight">Ensure Proper SGX Device Permissions</a></li><li><a href="#aesm-service" class="table-of-contents__link toc-highlight">AESM Service</a></li><li><a href="#dcap-attestation" class="table-of-contents__link toc-highlight">DCAP Attestation</a><ul><li><a href="#ubuntu-2204" class="table-of-contents__link toc-highlight">Ubuntu 22.04+</a></li><li><a href="#configuring-the-quote-provider" class="table-of-contents__link toc-highlight">Configuring the Quote Provider</a></li><li><a href="#dcap-attestation-docker" class="table-of-contents__link toc-highlight">DCAP Attestation Docker</a></li><li><a href="#multi-socket-systems" class="table-of-contents__link toc-highlight">Multi-socket Systems</a></li></ul></li><li><a href="#migrate-from-epid-attestation-to-dcap-attestation" class="table-of-contents__link toc-highlight">Migrate from EPID Attestation to DCAP Attestation</a></li><li><a href="#check-sgx-setup" class="table-of-contents__link toc-highlight">Check SGX Setup</a><ul><li><a href="#install-dependencies" class="table-of-contents__link toc-highlight">Install Dependencies</a></li><li><a href="#install-rust" class="table-of-contents__link toc-highlight">Install Rust</a></li><li><a href="#build-and-install-sgxs-tools" class="table-of-contents__link toc-highlight">Build and Install sgxs-tools</a></li><li><a href="#run-sgx-detect-tool" class="table-of-contents__link toc-highlight">Run <code>sgx-detect</code> Tool</a></li><li><a href="#oasis-attestation-tool" class="table-of-contents__link toc-highlight">Oasis Attestation tool</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#aesm-could-not-be-contacted" class="table-of-contents__link toc-highlight">AESM could not be contacted</a></li><li><a href="#aesm-error-30" class="table-of-contents__link toc-highlight">AESM: error 30</a></li><li><a href="#permission-denied-when-accessing-sgx-kernel-device" class="table-of-contents__link toc-highlight">Permission Denied When Accessing SGX Kernel Device</a></li><li><a href="#error-opening-sgx-kernel-device" class="table-of-contents__link toc-highlight">Error Opening SGX Kernel Device</a></li><li><a href="#unable-to-launch-enclaves-operation-not-permitted" class="table-of-contents__link toc-highlight">Unable to Launch Enclaves: Operation not permitted</a></li><li><a href="#unable-to-launch-enclaves-invalid-argument" class="table-of-contents__link toc-highlight">Unable to Launch Enclaves: Invalid argument</a></li><li><a href="#unable-to-launch-enclaves-inputoutput-error" class="table-of-contents__link toc-highlight">Unable to Launch Enclaves: Input/output error</a></li><li><a href="#couldnt-find-the-platform-library" class="table-of-contents__link toc-highlight">Couldn&#39;t find the platform library</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">General</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://explorer.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer</a></li><li class="footer__item"><a href="https://wallet.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wallet</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol/cli" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI</a></li><li class="footer__item"><a href="https://status.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status</a></li></ul></div><div class="col footer__col"><div class="footer__title">Build</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://faucet.testnet.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testnet Faucet</a></li><li class="footer__item"><a href="https://playground.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground</a></li><li class="footer__item"><a href="https://api.docs.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Node</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/node/mainnet/">Mainnet</a></li><li class="footer__item"><a class="footer__link-item" href="/node/testnet/">Testnet</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://oasis.io/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://t.me/oasisprotocolcommunity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC35UFPcZ2F1wjPxhPrSsESQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<p xmlns:cc="http://creativecommons.org/ns#">Copyright © 2025
by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://oasisprotocol.org">
Oasis Protocol Foundation</a>.
Unless otherwise specified, all text and images on this website are licensed
under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/cc.svg"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/by.svg"></a>.
This does not include the Oasis software and the code examples, both of which are
licensed under <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
Apache 2.0</a>. Built with &#x2665; and Docusaurus.</p></div></div></div></footer></div>
</body>
</html>