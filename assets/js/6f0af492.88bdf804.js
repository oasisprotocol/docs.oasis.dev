"use strict";(self.webpackChunkdocs_oasis_io=self.webpackChunkdocs_oasis_io||[]).push([[8681],{5869:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"general/manage-tokens/cli/rofl","title":"ROFL","description":"Manage \\"Runtime OFfchain Logic\\" apps","source":"@site/docs/general/manage-tokens/cli/rofl.md","sourceDirName":"general/manage-tokens/cli","slug":"/general/manage-tokens/cli/rofl","permalink":"/general/manage-tokens/cli/rofl","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/cli/edit/master/docs/rofl.md","tags":[],"version":"current","lastUpdatedAt":1739958268000,"frontMatter":{"title":"ROFL","description":"Manage \\"Runtime OFfchain Logic\\" apps"},"sidebar":"general","previous":{"title":"Address book","permalink":"/general/manage-tokens/cli/addressbook"},"next":{"title":"Frequently Asked Questions","permalink":"/general/manage-tokens/faq"}}');var a=t(4848),s=t(8453);const r={title:"ROFL",description:'Manage "Runtime OFfchain Logic" apps'},o="Manage ROFL Apps",c={},d=[{value:"Initialize a new ROFL app manifest",id:"init",level:2},{value:"Create a new ROFL app on the network",id:"create",level:2},{value:"Build ROFL",id:"build",level:2},{value:"Update ROFL app config",id:"update",level:2},{value:"Remove ROFL app from the network",id:"remove",level:2},{value:"Show ROFL information",id:"show",level:2},{value:"Advanced",id:"advanced",level:2},{value:"Show ROFL identity",id:"identity",level:3},{value:"Show the current trust-root",id:"trust-root",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"manage-rofl-apps",children:"Manage ROFL Apps"})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"rofl"})," command combines a series of actions for managing the ",(0,a.jsx)(n.a,{href:"/build/rofl/",children:"Runtime\nOFfchain Logic (ROFL)"})," apps:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"build ROFL locally,"}),"\n",(0,a.jsx)(n.li,{children:"verify the ROFL bundle,"}),"\n",(0,a.jsx)(n.li,{children:"register, deregister and update ROFL apps on the network,"}),"\n",(0,a.jsx)(n.li,{children:"show information about the registered ROFL apps,"}),"\n",(0,a.jsx)(n.li,{children:"other convenient tooling for ROFL app developers."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"init",children:"Initialize a new ROFL app manifest"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"rofl init"})," command will prepare a new ROFL app manifest in the given\ndirectory (defaults to the current directory). The manifest is a YAML file named\n",(0,a.jsx)(n.code,{children:"rofl.yaml"})," which defines the versions of all components, upgrade policies, etc.\nneeded to manage, build and deploy the ROFL app."]}),"\n",(0,a.jsxs)(n.p,{children:["You can also define specific ",(0,a.jsx)(n.a,{href:"/general/manage-tokens/cli/account#npa",children:"Network, ParaTime and Account"})," parameters\nas those get recorded into the manfiest so you don't need to specify them on\neach invocation:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl init --network testnet --account my_rofl_acc\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Creating a new ROFL app with default policy...\nName:     myapp\nVersion:  0.1.0\nTEE:      tdx\nKind:     container\nDeployment 'default':\n  Network:  testnet\n  ParaTime: sapphire\n  Debug:    false\n  Admin:    test_a\nCreated manifest in 'rofl.yaml'.\nRun `oasis rofl create --update-manifest` to register your ROFL app and configure an app ID.\n"})}),"\n",(0,a.jsx)(n.h2,{id:"create",children:"Create a new ROFL app on the network"}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"rofl create"})," to register a new ROFL app on the network using an existing\nmanifest."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl create --update-manifest\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'You are about to sign the following transaction:\nFormat: plain\nMethod: rofl.Create\nBody:\n  {\n    "policy": {\n      "quotes": {\n        "pcs": {\n          "tcb_validity_period": 30,\n          "min_tcb_evaluation_data_number": 17,\n          "tdx": {}\n        }\n      },\n      "enclaves": [],\n      "endorsements": [\n        {\n          "any": {}\n        }\n      ],\n      "fees": 2,\n      "max_expiration": 3\n    },\n    "scheme": 1\n  }\nAuthorized signer(s):\n  1. sk5kvBHaZ/si0xXRdjllIOxOgr7o2d1K+ckVaU3ndG4= (ed25519)\n     Nonce: 319\nFee:\n  Amount: 0.0101405 TEST\n  Gas limit: 101405\n  (gas price: 0.0000001 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: sapphire (Sapphire Testnet)\nAccount:  test:alice\n? Sign this transaction? Yes\n(In case you are using a hardware-based signer you may need to confirm on device.)\nBroadcasting transaction...\nTransaction included in block successfully.\nRound:            412\nTransaction hash: 2d8ef6e832256986a19d7b92dcf182976205c5247aff71487832877ff4d72edd\nExecution successful.\nCreated ROFL app: rofl1qzd82n99vtwesvcqjfyur4tcm45varz2due7s635\nRun `oasis rofl build --update-manifest` to build your ROFL app.\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Returned is the unique ROFL app ID starting with ",(0,a.jsx)(n.code,{children:"rofl1"})," and which you\nwill refer to for managing your ROFL app in the future. If you specify the\n",(0,a.jsx)(n.code,{children:"--update-manifest"})," parameter the manifest will be automatically updated with\nthe newly assigned app identifier."]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["In order to prevent spam attacks registering a ROFL app requires a\ncertain amount to be deposited from your account until you decide to\n",(0,a.jsx)(n.a,{href:"#remove",children:"remove it"}),". The deposit remains locked for the lifetime of the app.\nCheck out the ",(0,a.jsx)(n.a,{href:"/build/rofl/app",children:"ROFL chapter"})," to view the current staking requirements."]})}),"\n",(0,a.jsxs)(n.p,{children:["With the ",(0,a.jsx)(n.code,{children:"--scheme"})," parameter, you can select one of the following ROFL app ID\nderivation schemes:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"cn"})," for the ROFL app creator address (the account you're using to sign the\ntransaction) combined with the account's nonce (default). This behavior is\nsimilar to the one of the Ethereum ",(0,a.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/accounts/#contract-accounts",children:"smart contract address derivation"})," and is\ndeterministic."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"cri"})," uses the ROFL app creator address combined with the block round the\ntransaction will be validated in and its position inside that block."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"build",children:"Build ROFL"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"rofl build"})," command will execute a series of build commands depending on\nthe target Trusted Execution Environment (TEE) and produce the Oasis Runtime\nContainer (ORC) bundle."]}),"\n",(0,a.jsx)(n.p,{children:"Additionally, the following flags are available:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"--update-manifest"})," updates the enclave identity in the app manifest with the\nidentity of the locally built app."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"--output"})," the filename of the output ORC bundle. Defaults to the pattern\n",(0,a.jsx)(n.code,{children:"<name>.<deployment>.orc"})," where ",(0,a.jsx)(n.code,{children:"<name>"})," is the app name from the manifest and\n",(0,a.jsx)(n.code,{children:"<deployment>"})," is the deployment name from the manifest."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"--verify"})," also verifies the locally built enclave identity against the\nidentity that is currently defined in the manifest and also against the\nidentity that is currently set in the on-chain policy."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Building ROFL apps does not require a working TEE on your machine. However, you\ndo need to install all corresponding tools. Check out the ",(0,a.jsx)(n.a,{href:"/build/rofl/prerequisites",children:"ROFL Prerequisites"}),"\nchapter for details."]})}),"\n",(0,a.jsx)(n.h2,{id:"update",children:"Update ROFL app config"}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"rofl update"})," command to update the ROFL app's configuration on chain:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl update\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:'You are about to sign the following transaction:\nFormat: plain\nMethod: rofl.Update\nBody:\n  {\n    "id": "rofl1qzd82n99vtwesvcqjfyur4tcm45varz2due7s635",\n    "policy": {\n      "quotes": {\n        "pcs": {\n          "tcb_validity_period": 30,\n          "min_tcb_evaluation_data_number": 17,\n          "tdx": {}\n        }\n      },\n      "enclaves": [],\n      "endorsements": [\n        {\n          "any": {}\n        }\n      ],\n      "fees": 2,\n      "max_expiration": 3\n    },\n    "admin": "oasis1qpwaggvmhwq5uk40clase3knt655nn2tdy39nz2f"\n  }\nAuthorized signer(s):\n  1. sk5kvBHaZ/si0xXRdjllIOxOgr7o2d1K+ckVaU3ndG4= (ed25519)\n     Nonce: 320\nFee:\n  Amount: 0.010145 TEST\n  Gas limit: 101450\n  (gas price: 0.0000001 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: sapphire (Sapphire Testnet)\nAccount:  test:alice\n? Sign this transaction? Yes\n(In case you are using a hardware-based signer you may need to confirm on device.)\nBroadcasting transaction...\nTransaction included in block successfully.\nRound:            310\nTransaction hash: 2d8ef6e832256986a19d7b92dcf182976205c5247aff71487832877ff4d72edd\nExecution successful.\n'})}),"\n",(0,a.jsx)(n.h2,{id:"remove",children:"Remove ROFL app from the network"}),"\n",(0,a.jsxs)(n.p,{children:["Run ",(0,a.jsx)(n.code,{children:"rofl remove"})," to deregister your ROFL app:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl remove\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'You are about to sign the following transaction:\nFormat: plain\nMethod: rofl.Remove\nBody:\n  {\n    "id": "rofl1qzd82n99vtwesvcqjfyur4tcm45varz2due7s635"\n  }\nAuthorized signer(s):\n  1. sk5kvBHaZ/si0xXRdjllIOxOgr7o2d1K+ckVaU3ndG4= (ed25519)\n     Nonce: 321\nFee:\n  Amount: 0.0011288 TEST\n  Gas limit: 11288\n  (gas price: 0.0000001 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: sapphire (Sapphire Testnet)\nAccount:  test:alice\n? Sign this transaction? Yes\n(In case you are using a hardware-based signer you may need to confirm on device.)\nBroadcasting transaction...\nTransaction included in block successfully.\nRound:            510\nTransaction hash: b3a6f36c7a846dcf3f28c2dd3d2383cc2c3f7c1e05cea4be92fff2338849d825\nExecution successful.\n'})}),"\n",(0,a.jsx)(n.p,{children:"The deposit required to register the ROFL app will be returned to the current\nadministrator account."}),"\n",(0,a.jsx)(n.h2,{id:"show",children:"Show ROFL information"}),"\n",(0,a.jsxs)(n.p,{children:["Run ",(0,a.jsx)(n.code,{children:"rofl show"})," to obtain the information from the network on the ROFL admin\naccount, staked amount, current ROFL policy and running instances:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl show\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'App ID:        rofl1qzd82n99vtwesvcqjfyur4tcm45varz2due7s635\nAdmin:         oasis1qrec770vrek0a9a5lcrv0zvt22504k68svq7kzve\nStaked amount: 10000.0\nPolicy:\n  {\n    "quotes": {\n      "pcs": {\n        "tcb_validity_period": 30,\n        "min_tcb_evaluation_data_number": 17,\n        "tdx": {}\n      }\n    },\n    "enclaves": [\n      "z+StFagJfBOdGlUGDMH7RlcNUm1uqYDUZDG+g3z2ik8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",\n      "6KfY4DqD1Vi+H7aUn5FwwLobEzERHoOit7xsrPNz3eUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="\n    ],\n    "endorsements": [\n      {\n        "any": {}\n      }\n    ],\n    "fees": 2,\n    "max_expiration": 3\n  }\n\n=== Instances ===\n- RAK:        UwuhJrOYX6FDOc27NilQSrcVEtWD9voq+ST+ohsaRTI=\n  Node ID:    DbeoxcRwDO4Wh8bwq5rAR7wzhiB+LeYn+y7lFSGAZ7I=\n  Expiration: 7\n'})}),"\n",(0,a.jsx)(n.h2,{id:"advanced",children:"Advanced"}),"\n",(0,a.jsx)(n.h3,{id:"identity",children:"Show ROFL identity"}),"\n",(0,a.jsxs)(n.p,{children:["Run ",(0,a.jsx)(n.code,{children:"rofl identity"})," to compute the ",(0,a.jsx)(n.strong,{children:"cryptographic identity"})," of the ROFL app:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl identity rofl-oracle.orc\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"wzwUd5Ym/e5OO87pGVk2yWL4v0x12U3Zx/48Vdoe1PyTBkRbZbh9kPyqgY1RsvenXEIHQA0c2nR/WlmvS1vbcg==\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The output above is Base64-encoded enclave identity which depends on the ROFL\nsource code and the build environment. Enclave identities should be reproducible\non any computer and are used to prove and verify the integrity of ROFL binaries\non the network. See the ",(0,a.jsx)(n.a,{href:"/build/tools/build-paratime/reproducibility",children:"Reproducibility"})," chapter to learn more."]}),"\n",(0,a.jsx)(n.h3,{id:"trust-root",children:"Show the current trust-root"}),"\n",(0,a.jsxs)(n.p,{children:["In order the ROFL app can trust the environment it is executed in, it\nneeds to have a hardcoded ",(0,a.jsx)(n.em,{children:"trust root"}),". Typically, it consists of:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["the ",(0,a.jsx)(n.a,{href:"/core/runtime/identifiers",children:"ParaTime ID"}),","]}),"\n",(0,a.jsxs)(n.li,{children:["the ",(0,a.jsx)(n.a,{href:"/core/crypto#chain-domain-separation",children:"chain domain separation context"}),","]}),"\n",(0,a.jsx)(n.li,{children:"the specific consensus block hash and its height."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["To obtain the latest trust root in rust programming language, run\n",(0,a.jsx)(n.code,{children:"oasis rofl trust-root"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl trust-root\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'TrustRoot {\n    height: 1022,\n    hash: "bb3e63d729dd568ce07b37eea33eddf8082ed4cacbd64097aad32168a4a4fc9a".into(),\n    runtime_id: "8000000000000000000000000000000000000000000000000000000000000000".into(),\n    chain_context: "074f5ba071c4385a7ad24aea0a3a7b137901395e8f3b35479c1cce87d3170f4e".to_string(),\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["You can also define specific ",(0,a.jsx)(n.a,{href:"/general/manage-tokens/cli/account#npa",children:"Network and ParaTime"})," parameters:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"oasis rofl trust-root --network testnet --paratime sapphire\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(6540);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);