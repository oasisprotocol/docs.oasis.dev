"use strict";(self.webpackChunkdocs_oasis_io=self.webpackChunkdocs_oasis_io||[]).push([[6394],{5328:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"build/sapphire/ethereum","title":"Sapphire vs Ethereum","description":"Differences to Ethereum","source":"@site/docs/build/sapphire/ethereum.mdx","sourceDirName":"build/sapphire","slug":"/build/sapphire/ethereum","permalink":"/build/sapphire/ethereum","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/sapphire-paratime/edit/main/docs/ethereum.mdx","tags":[],"version":"current","lastUpdatedAt":1740673730000,"frontMatter":{"description":"Differences to Ethereum"},"sidebar":"developers","previous":{"title":"Network information","permalink":"/build/sapphire/network"},"next":{"title":"Develop on Sapphire","permalink":"/build/sapphire/develop/"}}');var s=n(4848),a=n(8453),i=n(4405),o=n(4117);const c={description:"Differences to Ethereum"},l="Sapphire vs Ethereum",d={},h=[{value:"Encrypted Contract State",id:"encrypted-contract-state",level:2},{value:"End-to-End Encrypted Transactions and Calls",id:"end-to-end-encrypted-transactions-and-calls",level:2},{value:"<code>from</code> Address is Zero for Unsigned Calls",id:"from-address-is-zero-for-unsigned-calls",level:2},{value:"Override <code>receive</code> and <code>fallback</code> when Funding the Contract",id:"override-receive-and-fallback-when-funding-the-contract",level:2},{value:"Instant Finality",id:"instant-finality",level:2},{value:"See also",id:"see-also",level:2}];function u(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"sapphire-vs-ethereum",children:"Sapphire vs Ethereum"})}),"\n",(0,s.jsxs)(t.p,{children:["Sapphire is generally compatible with Ethereum, the EVM, and all the user and\ndeveloper tooling that you are used to. In addition to confidentiality\nfeatures, you get a few extra benefits including the ability to ",(0,s.jsx)(t.strong,{children:"generate\nprivate entropy"}),", and ",(0,s.jsx)(t.strong,{children:"make signatures on-chain"}),". An example of a dApp that\nuses both is an HSM contract that generates an Ethereum wallet and signs\ntransactions sent to it via transactions."]}),"\n",(0,s.jsx)(t.p,{children:"There are also a few breaking changes compared to Ethereum though, but we think\nthat you'll quickly grasp them:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"#encrypted-contract-state",children:"Encrypted Contract State"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"#end-to-end-encrypted-transactions-and-calls",children:"End-to-End Encrypted Transactions and Calls"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsxs)(t.a,{href:"#from-address-is-zero-for-unsigned-calls",children:[(0,s.jsx)(t.code,{children:"from"})," Address is Zero for Unsigned Calls"]})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsxs)(t.a,{href:"#override-receive-and-fallback-when-funding-the-contract",children:["Override ",(0,s.jsx)(t.code,{children:"receive"})," and ",(0,s.jsx)(t.code,{children:"fallback"})," when Funding the Contract"]})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"#instant-finality",children:"Instant Finality"})}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Read below to learn more about them. Otherwise, Sapphire is like Emerald, a\nfast, cheap Ethereum."}),"\n",(0,s.jsx)(t.h2,{id:"encrypted-contract-state",children:"Encrypted Contract State"}),"\n",(0,s.jsxs)(t.p,{children:["The contract state is only visible to the contract that wrote it. With respect\nto the contract API, it's as if all state variables are declared as ",(0,s.jsx)(t.code,{children:"private"}),",\nbut with the further restriction that not even full nodes can read the values.\nPublic or access-controlled values are provided instead through explicit\ngetters."]}),"\n",(0,s.jsxs)(t.p,{children:["Calling ",(0,s.jsx)(t.code,{children:"eth_getStorageAt()"})," will return zero."]}),"\n",(0,s.jsx)(t.h2,{id:"end-to-end-encrypted-transactions-and-calls",children:"End-to-End Encrypted Transactions and Calls"}),"\n",(0,s.jsx)(t.p,{children:"Transactions and calls are end-to-end encrypted into the contract. Only the\ncaller and the contract can see the data sent to/received from the ParaTime.\nThis ends up defeating some utility of block explorers, however."}),"\n",(0,s.jsx)(t.p,{children:"The status of the transaction is public and so are the error code, the revert\nmessage and logs (emitted events)."}),"\n",(0,s.jsxs)(t.h2,{id:"from-address-is-zero-for-unsigned-calls",children:[(0,s.jsx)(t.code,{children:"from"})," Address is Zero for Unsigned Calls"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"from"})," address using of calls is derived from a signature attached to the\ncall. Unsigned calls have their sender set to the zero address. This allows\ncontract authors to write getters that release secrets to authenticated callers\n(e.g. by checking the ",(0,s.jsx)(t.code,{children:"msg.sender"})," value), but without requiring a transaction\nto be posted on-chain."]}),"\n",(0,s.jsxs)(t.h2,{id:"override-receive-and-fallback-when-funding-the-contract",children:["Override ",(0,s.jsx)(t.code,{children:"receive"})," and ",(0,s.jsx)(t.code,{children:"fallback"})," when Funding the Contract"]}),"\n",(0,s.jsx)(t.p,{children:"In Ethereum, you can fund a contract by sending Ether along the transaction in\ntwo ways:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["a transaction must call a ",(0,s.jsx)(t.em,{children:"payable"})," function in the contract, or"]}),"\n",(0,s.jsxs)(t.li,{children:["not calling any specific function (i.e. empty ",(0,s.jsx)(t.em,{children:"calldata"}),"). In this case,\nthe payable ",(0,s.jsx)(t.code,{children:"receive()"})," and/or ",(0,s.jsx)(t.code,{children:"fallback()"})," functions need to be defined in\nthe contract. If no such functions exist, the transaction will revert."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The behavior described above is the same in Sapphire when using EVM transactions\nto fund a contract."}),"\n",(0,s.jsxs)(t.p,{children:["However, the Oasis Network also uses ",(0,s.jsx)(t.a,{href:"/general/manage-tokens/",children:"Oasis-native transactions"})," such as a\ndeposit to a ParaTime account or a transfer. In this case, ",(0,s.jsxs)(t.strong,{children:["you will be able to\nfund the contract's account even though the contract may not implement payable\n",(0,s.jsx)(t.code,{children:"receive()"})," or ",(0,s.jsx)(t.code,{children:"fallback()"}),"!"]})," Or, if these functions do exist, ",(0,s.jsx)(t.strong,{children:"they will not\nbe triggered"}),". You can send such Oasis-native transactions by using the ",(0,s.jsx)(t.a,{href:"/general/manage-tokens/cli/",children:"Oasis\nCLI"})," for example."]}),"\n",(0,s.jsx)(t.h2,{id:"instant-finality",children:"Instant Finality"}),"\n",(0,s.jsx)(t.p,{children:"The Oasis Network is a proof of stake network where 2/3+ of the validator nodes\nneed to verify each block in order to consider it final. However, in Ethereum\nthe signatures of those validator nodes can be submitted minutes after the block\nis proposed, which makes the block proposal mechanism independent of the\nvalidation, but adds uncertainty if and when will the proposed block actually be\nfinalized."}),"\n",(0,s.jsxs)(t.p,{children:["In the Oasis Network, the 2/3+ of signatures need to be provided immediately\nafter the block is proposed and ",(0,s.jsx)(t.strong,{children:"the network will halt, until the required\nnumber signatures are provided"}),". This means that you can rest assured that any\nvalidated block is final. As a consequence, the cross-chain bridges are more\nresponsive yet safe on the Oasis Network."]}),"\n",(0,s.jsx)(t.h2,{id:"see-also",children:"See also"}),"\n",(0,s.jsx)(i.A,{item:(0,o.$)("/build/sapphire/develop/concept")})]})}function p(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},4405:(e,t,n)=>{n.d(t,{A:()=>g});n(6540);var r=n(4164),s=n(6289),a=n(3751),i=n(1430),o=n(2887),c=n(539),l=n(9303);const d={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var h=n(4848);function u(e){let{href:t,children:n}=e;return(0,h.jsx)(s.A,{href:t,className:(0,r.A)("card padding--lg",d.cardContainer),children:n})}function p(e){let{href:t,icon:n,title:s,description:a}=e;return(0,h.jsxs)(u,{href:t,children:[(0,h.jsxs)(l.A,{as:"h2",className:(0,r.A)("text--truncate",d.cardTitle),title:s,children:[n," ",s]}),a&&(0,h.jsx)("p",{className:(0,r.A)("text--truncate",d.cardDescription),title:a,children:a})]})}function f(e){let{item:t}=e;const n=(0,a.Nr)(t),r=function(){const{selectMessage:e}=(0,i.W)();return t=>e(t,(0,c.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:t}))}();return n?(0,h.jsx)(p,{href:n,icon:"\ud83d\uddc3\ufe0f",title:t.label,description:t.description??r(t.items.length)}):null}function m(e){let{item:t}=e;const n=(0,o.A)(t.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",r=(0,a.cC)(t.docId??void 0);return(0,h.jsx)(p,{href:t.href,icon:n,title:t.label,description:t.description??r?.description})}function g(e){let{item:t}=e;switch(t.type){case"link":return(0,h.jsx)(m,{item:t});case"category":return(0,h.jsx)(f,{item:t});default:throw new Error(`unknown item type ${JSON.stringify(t)}`)}}},1430:(e,t,n)=>{n.d(t,{W:()=>l});var r=n(6540),s=n(797);const a=["zero","one","two","few","many","other"];function i(e){return a.filter((t=>e.includes(t)))}const o={locale:"en",pluralForms:i(["one","other"]),select:e=>1===e?"one":"other"};function c(){const{i18n:{currentLocale:e}}=(0,s.A)();return(0,r.useMemo)((()=>{try{return function(e){const t=new Intl.PluralRules(e);return{locale:e,pluralForms:i(t.resolvedOptions().pluralCategories),select:e=>t.select(e)}}(e)}catch(t){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${t.message}\n`),o}}),[e])}function l(){const e=c();return{selectMessage:(t,n)=>function(e,t,n){const r=e.split("|");if(1===r.length)return r[0];r.length>n.pluralForms.length&&console.error(`For locale=${n.locale}, a maximum of ${n.pluralForms.length} plural forms are expected (${n.pluralForms.join(",")}), but the message contains ${r.length}: ${e}`);const s=n.select(t),a=n.pluralForms.indexOf(s);return r[Math.min(a,r.length-1)]}(n,t,e)}}},4117:(e,t,n)=>{n.d(t,{$:()=>i});var r=n(1858),s=n(797);function a(e){for(const t of e){const e=t.href;e&&void 0===globalThis.sidebarItemsMap[e]&&(globalThis.sidebarItemsMap[e]=t),"category"===t.type&&a(t.items)}}function i(e){const{siteConfig:t,siteMetadata:n}=(0,s.A)(),i=(0,r.r)();if(!i)throw new Error("Unexpected: cant find docsVersion in current context");if(void 0===globalThis.sidebarItemsMap){globalThis.sidebarItemsMap={};for(const e in i.docsSidebars)a(i.docsSidebars[e])}if(void 0===globalThis.sidebarItemsMap[e]){if(console.log(`Item ${e} not found. Registered sidebar items:`),console.log(globalThis.sidebarItemsMap),"throw"==t.onBrokenMarkdownLinks)throw new Error(`Unexpected: sidebar item with href ${e} does not exist.`);return globalThis.sidebarItemsMap["/general/"]}return globalThis.sidebarItemsMap[e]}},8453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var r=n(6540);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);